<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> How do I reinstall my packages for R 4.0 when many of them came from Github? | Michael DeCrescenzo</title>
  <meta name="description" content="[SITE UNDER CONSTRUCTION.] I am a statistical researcher working in quantitative/high-frequency finance. This site contains some info about me, some notes about my work, and blog posts about stats and statistical programming.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="How do I reinstall my packages for R 4.0 when many of them came from Github?" />
<meta property="og:description" content="A quick solution to an R upgrade headache" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/package-reinstall/" />
<meta property="article:published_time" content="2020-04-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-26T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How do I reinstall my packages for R 4.0 when many of them came from Github?"/>
<meta name="twitter:description" content="A quick solution to an R upgrade headache"/>

  
  
    
  
  
  <link rel="stylesheet" href="/css/style-classic.css">
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/about">About</a></li>
         
        <li><a href="/posts">Blog</a></li>
         
        <li><a href="/research">Public Research</a></li>
         
        <li><a href="/teaching">Teaching Resources</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /posts/visualizing-what-matters/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/posts/nonflat-implications/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2fpackage-reinstall%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2fpackage-reinstall%2f&text=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fpackage-reinstall%2f&is_video=false&description=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f&body=Check out this article: %2fposts%2fpackage-reinstall%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2fpackage-reinstall%2f&name=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f&description=A%20quick%20solution%20to%20an%20R%20upgrade%20headache">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2fpackage-reinstall%2f&t=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        How do I reinstall my packages for R 4.0 when many of them came from Github?
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-04-26 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-04-26</time>
          
        </div>
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/methods">Methods</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/methods" rel="tag">Methods</a>
            
             ,  
            <a class="tag-link" href="/tags/computational-methods" rel="tag">Computational Methods</a>
            
             ,  
            <a class="tag-link" href="/tags/r" rel="tag">R</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      


<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>R 4.0 <a href="https://cran.r-project.org/">is here</a>, and that’s great. Be warned that if you install it, you will lose all of your installed packages. How should you reinstall them?</p>
<p><strong>First,</strong> there’s something to be said for installing as you go rather than inheriting all of your packages from your past self. A major upgrade can be a good excuse to clean house, trim unnecessary stuff from your computer, and <a href="https://twitter.com/hadleywickham/status/1254387031842701312">install packages from scratch</a>. As much as I like to take this approach myself, I have to teach next week, so I want my R environment established quickly.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>If you don’t particularly want to install-as-you-go, one way to revitalize your R environment is to <em>record which packages you have installed</em> and automate their re-installation with some code. You can find several helpful online guides that <a href="https://rstats.wtf/maintaining-r.html#how-to-transfer-your-library-when-updating-r">walk through the main idea</a>: save the names of installed packages as a vector, and then pass these names to <code>install.packages()</code> to do a batch installation from CRAN.</p>
<p><strong>But what about the packages that don’t live on CRAN?</strong> My experiments with R have led me to install several packages from Github: maybe they were “development versions” that had yet to be published on CRAN, or they will never be on CRAN due to policy incompatibilities or the wishes of the package developer. (See Reason #5 in <a href="https://twitter.com/hadleywickham/status/1254421747014737920">this tweet</a>.) How can we automate the reinstall process when these packages have different online sources? This post walks through a process for doing that, adapted from this <a href="https://gist.github.com/mikedecr/6fd2e7855c71e4358534d5af3b72a03d">Gist</a> that I <a href="https://twitter.com/mikedecr/status/1254152352241782787">shared on Twitter</a>. I adapted the whole thing to go into a little <a href="https://github.com/mikedecr/update-R">Github repository</a> if you’d like to fork/clone that instead.</p>
</div>
<div id="roadmap" class="section level1">
<h1>Roadmap</h1>
<p>The routine has the following main ideas.</p>
<ol style="list-style-type: decimal">
<li>What packages have I installed, and where did they come from?</li>
<li>Check my local package versions against the CRAN versions. Are the most recent versions on CRAN, or was I using a Github version that I should keep using?</li>
<li>Render unto Caesar: install the packages from CRAN that makes sense to get from CRAN, but install the packages from Github that makes sense to get from Github.</li>
</ol>
</div>
<div id="what-is-already-installed" class="section level1">
<h1>What is already installed?</h1>
<p>First we collect information on the packages we already have installed. I am working out of a project directory that manages all of my R updating business, so I <a href="https://rstats.wtf/safe-paths.html">use the <code>{here}</code> package</a> consistent with a <a href="https://rstats.wtf/project-oriented-workflow.html">project-oriented R workflow</a>. We will also use tidyverse-style data manipulation.</p>
<pre class="r"><code>library(&quot;here&quot;)
library(&quot;tidyverse&quot;)
## Warning: package &#39;tibble&#39; was built under R version 4.0.2</code></pre>
<p>The <code>installed.packages()</code> function returns a table of package information for all packages in your library. I convert this to a tibble to make things easier.</p>
<pre class="r"><code># data frame of all installed packages
local_pkgs &lt;- installed.packages() %&gt;%
  as_tibble() %&gt;%
  print()
## # A tibble: 392 x 16
##    Package LibPath Version Priority Depends Imports LinkingTo Suggests Enhances
##    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;   
##  1 abind   /Libra… 1.4-5   &lt;NA&gt;     &quot;R (&gt;=… method… &lt;NA&gt;       &lt;NA&gt;    &lt;NA&gt;    
##  2 adagio  /Libra… 0.7.1   &lt;NA&gt;     &quot;R (&gt;=… graphi… &lt;NA&gt;       &lt;NA&gt;    &lt;NA&gt;    
##  3 ade4    /Libra… 1.7-15  &lt;NA&gt;     &quot;R (&gt;=… graphi… &lt;NA&gt;      &quot;ade4Tk… &lt;NA&gt;    
##  4 AER     /Libra… 1.2-9   &lt;NA&gt;     &quot;R (&gt;=… stats,… &lt;NA&gt;      &quot;boot, … &lt;NA&gt;    
##  5 Amelia  /Libra… 1.7.6   &lt;NA&gt;     &quot;R (&gt;=… foreig… Rcpp (&gt;=… &quot;tcltk,… &lt;NA&gt;    
##  6 arrayh… /Libra… 1.1-0   &lt;NA&gt;      &lt;NA&gt;   method… &lt;NA&gt;       &lt;NA&gt;    &lt;NA&gt;    
##  7 askpass /Libra… 1.1     &lt;NA&gt;      &lt;NA&gt;   sys (&gt;… &lt;NA&gt;      &quot;testth… &lt;NA&gt;    
##  8 assert… /Libra… 0.2.1   &lt;NA&gt;      &lt;NA&gt;   tools   &lt;NA&gt;      &quot;testth… &lt;NA&gt;    
##  9 audio   /Libra… 0.1-7   &lt;NA&gt;     &quot;R (&gt;=… &lt;NA&gt;    &lt;NA&gt;       &lt;NA&gt;    &lt;NA&gt;    
## 10 backpo… /Libra… 1.1.7   &lt;NA&gt;     &quot;R (&gt;=… utils   &lt;NA&gt;       &lt;NA&gt;    &lt;NA&gt;    
## # … with 382 more rows, and 7 more variables: License &lt;chr&gt;,
## #   License_is_FOSS &lt;chr&gt;, License_restricts_use &lt;chr&gt;, OS_type &lt;chr&gt;,
## #   MD5sum &lt;chr&gt;, NeedsCompilation &lt;chr&gt;, Built &lt;chr&gt;</code></pre>
<p>This is a start, but I also want to know if I got these packages from CRAN or from Github. I can do this with <code>sessioninfo::package_info()</code>, passing a vector of package names to the function.</p>
<pre class="r"><code># get source details (cran, github...) from package_info()
local_details &lt;- 
  sessioninfo::package_info(pkgs = local_pkgs$Package) %&gt;%
  as_tibble() %&gt;%
  select(package, local_version = ondiskversion, source) %&gt;%
  print()
## # A tibble: 378 x 3
##    package      local_version source        
##    &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;         
##  1 abind        1.4-5         CRAN (R 4.0.0)
##  2 adagio       0.7.1         CRAN (R 4.0.0)
##  3 ade4         1.7-15        CRAN (R 4.0.0)
##  4 AER          1.2-9         CRAN (R 4.0.0)
##  5 Amelia       1.7.6         CRAN (R 4.0.0)
##  6 arrayhelpers 1.1-0         CRAN (R 4.0.0)
##  7 askpass      1.1           CRAN (R 4.0.0)
##  8 assertthat   0.2.1         CRAN (R 4.0.0)
##  9 audio        0.1-7         CRAN (R 4.0.0)
## 10 backports    1.1.7         CRAN (R 4.0.0)
## # … with 368 more rows</code></pre>
<p>Notice that this new table has 14 fewer rows. That’s because <code>sessioninfo::package_info()</code> isn’t returning the base packages that show up in <code>installed.packages()</code>. That’s fine, since those will come with R 4.0 anyway.</p>
<p>The <code>source</code> column in this new table shows us what we want to know. For instance, let’s look at packages that I have from Github.</p>
<pre class="r"><code>filter(local_details, str_detect(source, &quot;Github&quot;))
## # A tibble: 8 x 3
##   package       local_version source                                   
##   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;                                    
## 1 colorout      1.2-2         Github (jalvesaq/colorout@726d681)       
## 2 emo           0.0.0.9000    Github (hadley/emo@3f03b11)              
## 3 ggkeyboard    0.0.0.9009    Github (sharlagelfand/ggkeyboard@b1a965d)
## 4 mRkov         0.0.0.9000    Github (serrat839/mRkov@0f520e8)         
## 5 rethinking    2.00          Github (rmcelreath/rethinking@f393f30)   
## 6 Statamarkdown 0.4.5         Github (hemken/Statamarkdown@506cfc9)    
## 7 texreg        1.36.28       Github (leifeld/texreg@c1da5c8)          
## 8 waffle        1.0.1         Github (hrbrmstr/waffle@3f61463)</code></pre>
</div>
<div id="determining-install-source-by-comparing-package-versions" class="section level1">
<h1>Determining install source by comparing package versions</h1>
<p>Before you update R, you may be using packages installed from Github, even if those packages are also on CRAN. We want to compare our locally installed package versions against the versions on CRAN. If the CRAN versions are more recent, we can go ahead and get those packages from CRAN. If the Github versions are still the most recent (or the <em>only</em>) versions of some packages, we want to get them from Github.</p>
<p>We will want to get a table of data on CRAN package versions. The <code>available.packages()</code> function returns info for <strong>all</strong> packages on CRAN.</p>
<pre class="r"><code># available.packages() returns pkg info for ALL pkgs on CRAN.
cran_pkgs &lt;- available.packages() %&gt;% 
  as_tibble(.name_repair = tolower) %&gt;%
  print()
## # A tibble: 16,578 x 17
##    package version priority depends imports linkingto suggests enhances license
##    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;  
##  1 A3      1.0.0   &lt;NA&gt;     R (&gt;= …  &lt;NA&gt;   &lt;NA&gt;      randomF… &lt;NA&gt;     GPL (&gt;…
##  2 aaSEA   1.1.0   &lt;NA&gt;     R(&gt;= 3… &quot;DT(&gt;=… &lt;NA&gt;      knitr, … &lt;NA&gt;     GPL-3  
##  3 AATtoo… 0.0.1   &lt;NA&gt;     R (&gt;= … &quot;magri… &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;     GPL-3  
##  4 ABACUS  1.0.0   &lt;NA&gt;     R (&gt;= … &quot;ggplo… &lt;NA&gt;      rmarkdo… &lt;NA&gt;     GPL-3  
##  5 abbyyR  0.5.5   &lt;NA&gt;     R (&gt;= … &quot;httr,… &lt;NA&gt;      testtha… &lt;NA&gt;     MIT + …
##  6 abc     2.1     &lt;NA&gt;     R (&gt;= …  &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;     GPL (&gt;…
##  7 abc.da… 1.0     &lt;NA&gt;     R (&gt;= …  &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;     GPL (&gt;…
##  8 ABC.RAP 0.9.0   &lt;NA&gt;     R (&gt;= … &quot;graph… &lt;NA&gt;      knitr, … &lt;NA&gt;     GPL-3  
##  9 abcADM  1.0     &lt;NA&gt;     &lt;NA&gt;    &quot;Rcpp … Rcpp, BH  &lt;NA&gt;     &lt;NA&gt;     GPL-3  
## 10 ABCana… 1.2.1   &lt;NA&gt;     R (&gt;= … &quot;plotr… &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;     GPL-3  
## # … with 16,568 more rows, and 8 more variables: license_is_foss &lt;chr&gt;,
## #   license_restricts_use &lt;chr&gt;, os_type &lt;chr&gt;, archs &lt;chr&gt;, md5sum &lt;chr&gt;,
## #   needscompilation &lt;chr&gt;, file &lt;chr&gt;, repository &lt;chr&gt;</code></pre>
<p>We only care about the packages in this table that we have already installed, so we will narrow the table down using a join.</p>
<pre class="r"><code>slimmer_frame &lt;- 
  left_join(
    x = select(local_details, package, local_version, source),
    y = select(cran_pkgs, package, cran_version = version)
  ) %&gt;%
  print()
## # A tibble: 378 x 4
##    package      local_version source         cran_version
##    &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;       
##  1 abind        1.4-5         CRAN (R 4.0.0) 1.4-5       
##  2 adagio       0.7.1         CRAN (R 4.0.0) 0.7.1       
##  3 ade4         1.7-15        CRAN (R 4.0.0) 1.7-16      
##  4 AER          1.2-9         CRAN (R 4.0.0) 1.2-9       
##  5 Amelia       1.7.6         CRAN (R 4.0.0) 1.7.6       
##  6 arrayhelpers 1.1-0         CRAN (R 4.0.0) 1.1-0       
##  7 askpass      1.1           CRAN (R 4.0.0) 1.1         
##  8 assertthat   0.2.1         CRAN (R 4.0.0) 0.2.1       
##  9 audio        0.1-7         CRAN (R 4.0.0) 0.1-7       
## 10 backports    1.1.7         CRAN (R 4.0.0) 1.2.0       
## # … with 368 more rows</code></pre>
<p>Using this slimmer table, we categorize the sources of these packages and where we want to reinstall them from. Here is the basic idea: <strong>We want to install from Github only if our local Github version is more recent than the CRAN version.</strong> This also applies when there is no version of a package on CRAN.</p>
<p>Stated another way, we install a package from CRAN in any case that the CRAN version is more recent than the local version. This is true even if the local version was installed from Github! Remember, we don’t install from Github simply because we did so in the past. We install from Github if there is no better choice.</p>
<p>There are edge cases to be aware of: we may find that the CRAN version of a package is behind our local version, <em>even if</em> the local version was installed from CRAN. This happens for (at least) two reasons: if a package version was reverted on CRAN (which appeared to happen in the case of <a href="https://github.com/cran/StanHeaders/commit/2294a66cb1876568b6af74a6c4a1233bf6b6e00f">StanHeaders</a>), or if the package is currently unavailable for installation from CRAN (due to some incompatibility, perhaps).</p>
<p>The code below does this categorization using the <code>utils::compareVersion()</code> function, which interprets the version numbers so we don’t have to. We do an additional step to note the Github repostory for any package that we still want to obtain from Github.</p>
<pre class="r"><code>compare_frame &lt;- slimmer_frame %&gt;%
  group_by(package) %&gt;% 
  mutate(
    source_locale = case_when(
      compareVersion(local_version, cran_version) == 1 &amp;
        str_detect(source, &quot;Github&quot;) ~ &quot;Github&quot;,
      compareVersion(local_version, cran_version) == 1 &amp;
        is.na(cran_version) &amp;
        str_detect(source, &quot;CRAN&quot;) ~ &quot;Unavailable on CRAN&quot;,
      compareVersion(local_version, cran_version) == 1 &amp;
        (is.na(cran_version) == FALSE) &amp;
        str_detect(source, &quot;CRAN&quot;) ~ &quot;Downgraded on CRAN&quot;,
      compareVersion(local_version, cran_version) %in% c(-1, 0) ~ &quot;CRAN&quot;
    ),
    github_repo = case_when(
      source_locale == &quot;Github&quot; ~ 
        str_split(string = source, pattern = &quot;@&quot;, simplify = TRUE)[,1] %&gt;%
        str_replace(&quot;Github \\(&quot;, &quot;&quot;),
      TRUE ~ as.character(NA)
    ),
  ) %&gt;%
  ungroup() %&gt;%
  print()
## # A tibble: 378 x 6
##    package     local_version source       cran_version source_locale github_repo
##    &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;      
##  1 abind       1.4-5         CRAN (R 4.0… 1.4-5        CRAN          &lt;NA&gt;       
##  2 adagio      0.7.1         CRAN (R 4.0… 0.7.1        CRAN          &lt;NA&gt;       
##  3 ade4        1.7-15        CRAN (R 4.0… 1.7-16       CRAN          &lt;NA&gt;       
##  4 AER         1.2-9         CRAN (R 4.0… 1.2-9        CRAN          &lt;NA&gt;       
##  5 Amelia      1.7.6         CRAN (R 4.0… 1.7.6        CRAN          &lt;NA&gt;       
##  6 arrayhelpe… 1.1-0         CRAN (R 4.0… 1.1-0        CRAN          &lt;NA&gt;       
##  7 askpass     1.1           CRAN (R 4.0… 1.1          CRAN          &lt;NA&gt;       
##  8 assertthat  0.2.1         CRAN (R 4.0… 0.2.1        CRAN          &lt;NA&gt;       
##  9 audio       0.1-7         CRAN (R 4.0… 0.1-7        CRAN          &lt;NA&gt;       
## 10 backports   1.1.7         CRAN (R 4.0… 1.2.0        CRAN          &lt;NA&gt;       
## # … with 368 more rows</code></pre>
</div>
<div id="updating-r-and-reinstalling-packages" class="section level1">
<h1>Updating R and reinstalling packages</h1>
<p>When we are satisfied with our decisions about where to install a package from, save this comparison table to file.</p>
<pre class="r"><code># output data location
dir.create(here(&quot;data&quot;))

# output file
out_file &lt;- as.character(str_glue(&quot;pkg-data_{Sys.Date()}.rds&quot;))
write_rds(compare_frame, here(&quot;data&quot;, out_file))</code></pre>
<p>After updating, we reopen R and install our packages according to our classifications. We want to begin by installing <code>{remotes}</code> to enable installation from Github.</p>
<pre class="r"><code># to install from github
install.packages(&quot;remotes&quot;)

# should still be operating in your working directory
# so downloading {here} makes sense also
install.packages(&quot;here&quot;)

# read package data
pkgs &lt;- readRDS(here::here(&quot;data&quot;, &quot;pkg-data_2020-04-25.rds&quot;))</code></pre>
<p>Everything that we want to install from Github, we install by iterating <code>remotes::install_github</code> over the github repository slugs that we saved previously. This requires us to write the code in “hard mode” because we aren’t using tidyverse dialect.</p>
<pre class="r"><code># install from github repos
github_pkgs &lt;- pkgs[pkgs$source_locale == &quot;Github&quot;, ][[&quot;github_repo&quot;]]

remotes::install_github(github_pkgs)</code></pre>
<p>Finally, everything that we said we wouldn’t get from Github, we get by using plain ol’ <code>install.packages()</code>. Before doing this, you may find it beneficial to filter out some of the packages that you don’t use anymore or that maybe we only installed as dependencies for other packages.</p>
<pre class="r"><code># install from cran with remaining package names
cran_pkgs &lt;- pkgs[pkgs$source_locale != &quot;Github&quot;, ][[&quot;package&quot;]]

install.packages(cran_pkgs)</code></pre>
<p>This should get you (more or less) up and running with R 4.0 and all of your old packages.</p>
<p>Fair warning: I’m already getting burned by some C++ configuration problems for packages that want to compile from source. I think this is particular to my own computer and the klugey fixes I undertook to set up <code>{rstan}</code> with MacOS Catalina. I remember reading somewhere that R 4.0 fixed some of the Stan x Catalina problems, so maybe I will confront these choices again soon, but I will cross that bridge when I get to it.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>
And maybe I will do a fresh install of <em>everything</em> once the semester is over.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/posts">Blog</a></li>
         
          <li><a href="/research">Public Research</a></li>
         
          <li><a href="/teaching">Teaching Resources</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2fpackage-reinstall%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2fpackage-reinstall%2f&text=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fpackage-reinstall%2f&is_video=false&description=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f&body=Check out this article: %2fposts%2fpackage-reinstall%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fposts%2fpackage-reinstall%2f&title=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2fpackage-reinstall%2f&name=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f&description=A%20quick%20solution%20to%20an%20R%20upgrade%20headache">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2fpackage-reinstall%2f&t=How%20do%20I%20reinstall%20my%20packages%20for%20R%204.0%20when%20many%20of%20them%20came%20from%20Github%3f">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left" align=right>
    Copyright  &copy; 2020  Michael DeCrescenzo 
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>


  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
